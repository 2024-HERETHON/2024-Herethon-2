{% extends "base.html" %}
{% load static %}

{% block content %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if folder %}{{ folder.name }}{% else %}Stuck{% endif %}</title>
    <link rel="stylesheet" href="{% static 'css/select_folder.css' %}">
    <style>
      
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px; /* 제목과 겹치지 않도록 여백 추가 */
        }

        .grid-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .grid-item img {
            width: 70px;
            height: 80px;
        }

        .top {
            display: flex;
            flex-direction: column;
            background-color: #f1f1f1;
            height: 180px;
            border-radius: 20px;
            margin-top: 25px;
            padding: 31px 24px;
            gap: 28px;
            justify-content: space-around;
        }

        .detail {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .left_circle {
            width: 40px;
            height: 40px;
        }

        .makequestion_before {
            width: 102px;
            height: 38px;
            background-color: #09A8FA;
            border-radius: 100px;
            border: none;
            font-size: 20px;
            color: white;
            font-weight: 700;
        }

        .makequestion_after {
            width: 102px;
            height: 38px;
            background-color: #09A8FA;
            border-radius: 100px;
            border: none;
            font-size: 20px;
            color: white;
            font-weight: 700;
        }

        .make_folders {
            width: 486px;
            height: 154px;
            border-radius: 20px;
            border: 2px solid var(--Teritary, #F1F1F1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 30px;
            margin-top: 40px; /* 상단과의 여백 추가 */
        }

        .make_folders h6 {
            color: black;
            margin-bottom: 24px;
        }

        #folder_name {
            border-radius: 20px;
            border: 0.5px solid var(--Secondary-Disabled, rgba(59, 59, 59, 0.20));
            background: var(--Teritary-Disabled, rgba(241, 241, 241, 0.20));
            box-shadow: -3px 4px 4px -3px rgba(0, 0, 0, 0.10) inset;
            width: 320px;
            height: 38px;
            padding: 0 18px;
        }

        #folder_name::placeholder {
            font-size: 12px;
            color: #3b3b3b;
        }

        .input_foldername button {
            padding: 7px 15px;  
            border-radius: 100px;
            background: var(--Primary-Hover, linear-gradient(0deg, rgba(255, 255, 255, 0.30) 0%, rgba(255, 255, 255, 0.30) 100%), #09A8FA);
            border: none;
            height: 31px;
            width: 81px;
            font-size: 14px;
            color: white;
        }
    </style>
</head>
<body>
    <main class="folder main">
      
        <section class="top">
          <div class="detail">
            <h4>저장할 폴더 정하기</h4>

            <!-- 폴더 경로 이동 섹션 -->
            {% if folder %}
            <section>
                {% if folder.parent %}
                <a href="{% url 'qna:select-folder' folder.parent.id %}">
                  <img src="{% static 'img/left_allow.png' %}" alt="left_arrow" class="left_circle">
                </a>
                {% else %}
                <a href="{% url 'qna:select-folder' 0 %}">
                  <img src="{% static 'img/left_allow.png' %}" alt="left_arrow" class="left_circle">
                </a>
                {% endif %}
            </section>
            {% endif %}
            
                <h6>{% if folder %}{{ path }}{% else %}Stuck/{% endif %}</h4>
                {% if folder %}
                <form method="POST" action="{% url 'qna:select-folder' folder.id %}">
                    {% csrf_token %}<button class="makequestion_before">Q&A 생성</button>
                </form>
                {% endif %}
                
            </div>
          
        </section>

        <section class="grid-container">
            <!-- 현재 폴더 하위에 있는 폴더 출력 -->
            {% for child in children %}
            <div class="grid-item">
                <a href="{% url 'qna:select-folder' child.id %}">
                    <img src="{% static 'img/folder.svg' %}" alt="Folder Icon">
                    <p>{{ child.name }}</p>
                </a>
            </div>
            {% endfor %}

            <!-- 현재 폴더 하위에 있는 Q 파일 출력 -->
            {% for q in folder.quizs.all %}
            <div class="grid-item">
                <img src="{% static 'img/q.png' %}" alt="Q File Icon">
                <p>{{ q.title }}</p>
            </div>
            {% endfor %}

            <!-- 현재 폴더 하위에 있는 T 파일 출력 -->
            {% for q in folder.qnas.all %}
            <div class="grid-item">
                <img src="{% static 'img/t.png' %}" alt="T File Icon">
                <p>{{ q.title }}</p>
            </div>
            {% endfor %}
        </section>

        <!-- 폴더 생성 섹션 -->
        <section class="make_folders">
            <h6>새로운 폴더 생성하기</h6>
            {% if folder %}
            <form action="{% url 'qna:add-folder' folder.id %}" method="POST">
                {% csrf_token %}
                <input type="text" id="folder_name" name="folder_name" placeholder="폴더명을 입력해주세요">
                <button type="submit" class="makequestion_before">폴더 생성</button>
            </form>
            {% else %}
            <form action="{% url 'qna:add-folder' 0 %}" method="POST">
                {% csrf_token %}
                <input type="text" id="folder_name" name="folder_name" placeholder="폴더명을 입력해주세요">
                <button type="submit" class="input_foldername">폴더 생성</button>
            </form>
            {% endif %}
        </section>

    </main>
</body>
</html>
{% endblock %}
